# VB-Permutor

## About

---

A Visual Basic Permutation library to allow complex and custom permuting of generic objects.

PermutationLibrary Version 1.8 (16/02/2020)

The online repository is available at <https://github.com/James-Wickenden/VB-Permutor>

Provides framework to allow generic permuting of arrays, either with or without repetition.
The permutator can handle up to 255 possible values when streaming.
A list of supported functionality is provided below, as well as a TODO for future functionality.

A class testing the library and demonstrating some of its functionality can be seen in the `TestPermutor.vb` class.

## TODO

---

- Input validation for typing
- Add parameter guidelines/ descriptions
- Config library as DLL (?)
- Make streamPermutor() private!
- Clean Up Permutor Interface; Public Subs and Method Formatting

## Functionality

---

## Parameters

There are several parameters held by the Permutor which determine the output of functions.

## Methods

- Constructor (for generic type T):

    ```VB
    Dim permutor As PermutationLibrary(Of T)
    Dim INPUT_VARARRAY() As T
    Dim PERMUTATION_SIZE As Integer
    Dim ALLOW_DUPLICATES As Boolean

    permutor = New PermutationLibrary(Of T)(PERMUTATION_SIZE, INPUT_VARARRAY, ALLOW_DUPLICATES)
    ```

- Get number of permutations as a Long:

    ```VB
    Dim noOfPermutations as Long = permutor.getNoOfPermutations()
    ```

    This function will return -1 in case of overflow; if there more than 2^64 permutations generated by the current parameters.

- Get a list of permutations:

    ```VB
    Dim permutations As New List(Of T())
    permutations = permutor.permuteToList()
    ```

    This function will return a list of the permutations generated by `permutor` with its current parameters. This is only suitable for smaller scale permutations, as the list returned by the function can only return max 2^28 references or a 2GB list.

    In this case, permute via a stream instead. This also allows computation on returned objects while generating new permutations in the permutor thread.

- Get a stream of permutations:

    ```VB
    Dim permutation as T()
    permutor.initStreamPermutor()

    While permutor.isStreamActive
        permutation = permutor.getPermutationFromStream()
    End While
    ```

    Here, the initStreamPermutor() will create an instance of the `StreamHandler` class. This will create a new thread that is initialised at the `permutor.streamPermutor()` function. This thread will generate permutations in order and place them in the stream.

    The `getPermutationFromStream()` function will pull the new permutation from the stream and return it. This call is safely looped through with the `isStreamActive()` function.

- Get a list of permutations using a faster algorithm:

    ```VB
     Dim permutations As List(Of T())

     permutations = permutor.basicPermuteToList()
    ```

    This provides a faster algorithm for returning a list of permutations than the `permuteToList()` uses.

    However, this will only generate permutations with no duplicate elements regardless of the state of the `allowDuplicates` flag in the Permutor! This function is given to cater for a more stereotypical use of permutations in better time complexity.

- Get a random permutation:

    ```VB
    Dim generator As New Random
    Dim randomPermutation() As T

    randomPermutation = permutor.getRandomPermutation(generator)
    ```

    This function returns a random permutation using the given Random object and the parameters held by the Permutor.
